/******************************************
 * FBR - "Funções úteis para o ScadaBR"
 * License: MIT
 ******************************************/
"use strict";fuscabr.calendar={start:function(){this.shouldCreateCalendars()&&("undefined"==typeof flatpickr?this.loadFlatpickr():(this.localizeFlatpickr(),this.createCalendars()))},createCalendars:function(){flatpickr(".fuscabr-calendar",{enableTime:!0,altInput:!0,dateFormat:"d/m/Y H:i:S"})},shouldCreateCalendars:function(){for(var e of this.conf.rules)for(var a of e.pages)if(window.location.pathname.includes(a)){var t=document.querySelectorAll(e.inputSelector);for(var n of t)n.classList.add("fuscabr-calendar");if(t.length)return!0}return!1},loadFlatpickr:function(){if(!this.loadStarted){this.loadStarted=!0;var e=document.createElement("script");e.src=this.conf.flatpickrLocaleFile,e.onload=function(){fuscabr.calendar.start()};var a=document.createElement("link");a.href=this.conf.flatpickrCSSFile,a.rel="stylesheet";var t=document.createElement("script");t.src=this.conf.flatpickrFile,t.onload=function(){document.getElementById("fuscabr-modules").appendChild(e)},document.getElementById("fuscabr-modules").appendChild(t),document.getElementById("fuscabr-modules").appendChild(a)}},localizeFlatpickr:function(){var e=fuscabr.common.conf.language;this.conf.detectBrowserLocale&&(e=(navigator.language||navigator.userLanguage).replace(/-.*/,"")),flatpickr.l10ns[e]?flatpickr.localize(flatpickr.l10ns[e]):console.warn("Flatpickr locale not found. Using default locale (English).")},getSettings:function(){ajaxGetJson("resources/fuscabr/conf/modules/calendar.json",function(e){fuscabr.calendar.conf=e,fuscabr.calendar.init()})},init:function(){fuscabr.calendar.conf?fuscabr.calendar.start():fuscabr.calendar.getSettings()}},fuscabr.calendar.init();
